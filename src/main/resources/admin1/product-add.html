 <!DOCTYPE html>
<html class="x-admin-sm">

    <head>
        <meta charset="UTF-8">
        <title>校园二手市场管理系统</title>
        <meta name="renderer" content="webkit">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi" />
        <link rel="stylesheet" href="./css/font.css">
        <link rel="stylesheet" href="./css/xadmin.css">
        <script src="./js/jquery.min.js" type="text/javascript"></script>
        <script type="text/javascript" src="./lib/layui/layui.js" charset="utf-8"></script>

        <script type="text/javascript" src="./js/xadmin.js"></script>
		<script type="text/javascript" src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
        <!-- 让IE8/9支持媒体查询，从而兼容栅格 -->
        <!--[if lt IE 9]>
            <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
            <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->
    </head>
    <body>
        <div class="layui-fluid">
            <div class="layui-row">
                <form class="layui-form">

                    <div class="layui-form-item">
                        <label class="layui-form-label">
                            <span class="x-red">*</span>作者ID
                        </label>
                        <div class="layui-input-inline">
                            <input type="text" id="a1" name="authorId"   lay-verify="required"
                                   autocomplete="off" class="layui-input">
                        </div>
                    </div>

                    <div class="layui-form-item">
                        <label class="layui-form-label">
                            <span class="x-red">*</span>分类
                        </label>
                        <div class="layui-input-inline">
                            <select name="catId" id="a2">
                            </select>
                        </div>
                    </div>

                    <div class="layui-form-item">
                        <label class="layui-form-label">
                            <span class="x-red">*</span>标题
                        </label>
                        <div class="layui-input-inline">
                            <input type="text" id="a3" name="title"   lay-verify="required"
                                   autocomplete="off" class="layui-input">
                        </div>
                    </div>

<!--                    <div class="layui-form-item">-->
<!--                        <label class="layui-form-label required" >内容</label>-->
<!--                        <div class="layui-input-inline" style="width: 600px">-->
<!--                            <textarea class="layui-textarea" id="content" placeholder="请输入内容"  style="display: none"  name="content" autocomplete="off"></textarea>-->
<!--                        </div>-->
<!--                    </div>-->
                    <div class="layui-form-item">
                        <label class="layui-form-label"><span class="x-red">*</span>内容</label>
                        <div class="layui-input-inline">
                            <textarea placeholder="请输入内容" id="content" name="content"  lay-verify="required" class="layui-textarea"></textarea>
                        </div>
                    </div>


<!--                    <div class="layui-form-item">-->
<!--                        <label class="layui-form-label">-->
<!--                            <span class="x-red">*</span>标签-->
<!--                        </label>-->
<!--                        <div class="layui-input-inline">-->
<!--                            <select multiple name="tags"  >-->
<!--                                <option type="checkbox" value="学习">学习</option>-->
<!--                                <option type="checkbox" value="运动">运动</option>-->
<!--                                <option type="checkbox" value="旅游">旅游</option>-->
<!--                                <option type="checkbox" value="美食">美食</option>-->
<!--                                <option type="checkbox" value="社交">社交</option>-->
<!--                                <option type="checkbox" value="音乐">音乐</option>-->
<!--                            </select>-->
<!--                        </div>-->
<!--                    </div>-->


                  <div class="layui-form-item">
                      <label class="layui-form-label">
                      </label>
                      <button  class="layui-btn" lay-filter="add" lay-submit="">
                          添加
                      </button>
                  </div>
              </form>
            </div>
        </div>


<!--        <script>-->
<!--            layui.use(['layedit','form'], function(){-->
<!--                var layedit = layui.layedit-->
<!--                    ,$ = layui.jquery-->
<!--                    ,form = layui.form;-->
<!--                //设置图片上传-->
<!--                layedit.set({-->
<!--                    uploadImage: {-->
<!--                        url: '/post/upload' //图片上传方法的接口url-->
<!--                        ,type: 'post' //默认post-->
<!--                    }-->
<!--                });-->
<!--                //构建富文本编辑器，构建方法一定要写在set方法下边-->
<!--                var index = layedit.build('content');-->

<!--                //校验表单的方法，并将富文本编辑器中的内容同步到文本域中-->
<!--                form.verify({-->
<!--                    content : function(value) {-->
<!--                        return layedit.sync(index); //同步语句-->
<!--                    }-->
<!--                });-->

<!--                //保存表单内容提交的方法-->
<!--                $('#fileNotifySubmit').on('click', function(){-->
<!--                    var active = {-->
<!--                        //获取纯文本内容： 111-->
<!--                        //如果要获取样式，将text替换成 content: <p>111</p>-->
<!--                        //如果要获取选中的文字，将text替换成selected：111-->
<!--                        text: function(){-->
<!--                            //获取富文本编辑器值的语句并赋值到文本域中-->
<!--                            document.getElementById("content").innerText = layedit-->
<!--                                .getContent(index);-->
<!--                        }-->
<!--                    };-->

<!--                    //保存表单内容的请求，此处为文件通知对象-->
<!--                    $.ajax({-->
<!--                        url:"/fileNotification/insert",-->
<!--                        type:"post",-->
<!--                        data:form,-->
<!--                        processData:false,-->
<!--                        contentType:false,-->
<!--                        success: function (result) {-->
<!--                            if (result.status ===true) {-->
<!--                                var index = parent.layer.getFrameIndex(window.name);-->
<!--                                parent.layer.close(index);-->
<!--                                parent.window.location.reload()-->
<!--                            }else {-->
<!--                                layer.msg(result.msg, { icon: 2, time: 1000 });-->
<!--                            }-->
<!--                        }-->
<!--                    });-->
<!--                });-->
<!--            });-->
<!--            //重新加载的方法-->
<!--            layui.use(['table', 'laydate','element'], function () {-->
<!--                var table = layui.table, form = layui.form, $ = layui.jquery;-->
<!--            });-->
<!--        </script>-->


        <script>
            var z =JSON.parse(sessionStorage.getItem('user'));
            $('#a1').val(z['id']);
            //var time=new Date().getTime();
            //$('#a5').val(getMyDate(time));
            layui.use(['form', 'layer','laydate'],function() {
                var k=$;
                $ = layui.jquery;
                form = layui.form,
                    layer = layui.layer;
                var laydate=layui.laydate;
                k.ajax({
                    url:url+"/category/getall",
                    method:"post",
                    data:{
                        origin:UrlHost(),
                        page:1,
                        pageSize:1000
                    },
                    dataType:"json",
                    success:function(msg){
                        console.log(msg);
                        var lists=msg.data[1];
                        console.log(lists);
                        var str='<option value="">请选择类型</option>';
                        for(var i in lists)
                        {
                            console.log(lists[i].name);
                            str+='<option value="'+lists[i].id+'">'+lists[i].name+'</option>';
                        }
                        $('#a2').html(str);
                        form.render('select');
                    }
                })

                layui.use(['form','code'],function (){
                    var form = layui.form;
                    $ = layui.$;
                })


                //监听提交
                form.on('submit(add)',function(data) {
                    data.field.t
					$.ajax({
						url:url+"/post/add",
						data:data.field,
						type:'post',
                        dataType:"json",
                        xhrFields:{
                            withCredentials:true
                        },
						success:function(msg){
						    console.log(msg);

							if(msg)
							{
								layer.alert("添加成功", {
									icon: 6
								},
								function() {
									//关闭当前frame
								    xadmin.close();

									// 可以对父窗口进行刷新
								    xadmin.father_reload();
								});
							}else{
                                layer.alert("添加失败", {
                                    icon: 5
                                })
							}

						}
					});


                    return false;
                });
            });
		</script>


        <script>var _hmt = _hmt || []; (function() {
                var hm = document.createElement("script");
                hm.src = "https://hm.baidu.com/hm.js?b393d153aeb26b46e9431fabaf0f6190";
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(hm, s);
            })();</script>
    </body>

</html>
